<% content_for :page_title, "MODIFY OPERATION" %>

<% content_for :breadcrumbs do %>
  <%= link_to @test_run.project.name, project_path(@test_run.project), class: "text-primary hover:text-primary/80" %>
  <span class="text-status-error mx-2">/</span>
  <%= link_to "Operations", project_test_runs_path(@test_run.project), class: "text-primary hover:text-primary/80" %>
  <span class="text-status-error mx-2">/</span>
  <%= link_to @test_run.name, test_run_path(@test_run), class: "text-primary hover:text-primary/80" %>
  <span class="text-status-error mx-2">/</span>
  <span class="text-text-muted">Modify</span>
<% end %>

<div class="max-w-4xl mx-auto">
  <div class="panel">
    <div class="panel-header flex items-center justify-between">
      <span>MODIFY OPERATION</span>
      <span class="text-[10px] font-mono text-primary">ID: #<%= @test_run.id %></span>
    </div>

    <div class="p-6">
      <%= form_with(model: @test_run, class: "space-y-6") do |form| %>
        <% if @test_run.errors.any? %>
          <div class="p-4 bg-status-error/10 border border-status-error/50 text-status-error font-mono text-sm animate-pulse" role="alert">
            <div class="flex items-center space-x-2 mb-2">
              <span class="w-2 h-2 bg-status-error rounded-full"></span>
              <span class="uppercase tracking-wider text-xs">System Error:</span>
            </div>
            <strong class="font-bold"><%= pluralize(@test_run.errors.count, "error") %> prohibited this operation from being updated:</strong>
            <ul class="mt-2 list-disc list-inside text-sm">
              <% @test_run.errors.each do |error| %>
                <li><%= error.full_message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div>
          <%= form.label :name, "Operation Designation", class: "block text-[10px] font-mono text-status-warning uppercase tracking-wider mb-2" %>
          <%= form.text_field :name, class: "input-field w-full px-4 py-3 text-sm", placeholder: "Enter operation designation..." %>
        </div>

        <div class="flex justify-end space-x-3 pt-6 border-t border-status-error/20">
          <%= link_to 'Abort', test_run_path(@test_run), class: "px-4 py-2 bg-dark-surface-mid border border-text-muted-dark text-text-muted text-xs font-mono uppercase tracking-wider hover:text-theme-primary transition-colors" %>
          <%= form.submit "Update Operation", class: "btn-primary cursor-pointer" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
